<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>Mass Template Maker</title>
        <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css" integrity="sha384-JcKb8q3iqJ61gNV9KGb8thSsNjpSL0n8PARn9HuZOnIxN0hoP+VmmDGMN5t9UJ0Z" crossorigin="anonymous">
    </head>
    <body>
    <button class="btn btn-primary rounded" id="new-template">Make New Template</button>
    <button class="btn btn-primary" id="copy-facebook-text-button" style="visibility: hidden;">Copy Facebook Text</button>
    <button class="btn btn-primary" id="copy-website-code-button" style="visibility: hidden;">Copy Website Code Text</button>
        <br>
    <input clasee="rounded" id="enter-date" type="date" placeholder="Date: mm/dd/yyyy">
    <input id="enter-day" type="text" placeholder="Day: Monday" style="visibility: collapse; display: none;">
    <select id="meridiem-indicator" name="Meridiem Indicator" style="display: none;">
        <option selected="selected">AM/PM</option>
        <option value="AM">AM</option>
        <option value="PM">PM</option>
    </select>
    <select id="liturgical-week" name="Liturgical Week" style="display: none;">
        <option selected="selected" value="">Liturgical Week</option>
        <option value="1st">1st</option>
        <option value="2nd">2nd</option>
        <option value="3rd">3rd</option>
        <option value="4th">4th</option>
        <option value="5th">5th</option>
        <option value="6th">6th</option>
        <option value="7th">7th</option>
        <option value="8th">8th</option>
        <option value="9th">9th</option>
        <option value="10th">10th</option>
        <option value="11th">11th</option>
        <option value="12th">12th</option>
        <option value="13th">13th</option>
        <option value="14th">14th</option>
        <option value="15th">15th</option>
        <option value="16th">16th</option>
        <option value="17th">17th</option>
        <option value="18th">18th</option>
        <option value="19th">19th</option>
        <option value="20th">20th</option>
        <option value="21st">21st</option>
        <option value="22nd">22nd</option>
        <option value="23rd">23rd</option>
        <option value="24th">24th</option>
        <option value="25th">25th</option>
        <option value="26th">26th</option>
        <option value="27th">27th</option>
        <option value="28th">28th</option>
        <option value="29th">29th</option>
        <option value="30th">30th</option>
        <option value="31st">31st</option>
        <option value="32nd">32nd</option>
        <option value="33rd">33rd</option>
        <option value="34th">34th</option>
    </select>
    <select id="celebrant" name="Celebrant Options" style="display: none;">
        <option selected="selected" value="">Celebrant:</option>
        <option value="Fr. John Ubel">Fr. John Ubel</option>
        <option value="Fr. Joseph Bambenek">Fr. Joseph Bambenek</option>
        <option value="Fr. Mark Pavlak">Fr. Mark Pavlak</option>
        <option value="Archbishop Bernard Hebda">Archbishop Bernard Hebda</option>
        <option value="Other">Other</option>
    </select>
    
    <input id="celebrant-text-input" type="text" placeholder="Fr. First Last" style="visibility: collapse; display: none;">
    <select id="liturgical-season" style="display: none;">
        <option selected="selected" value="">Liturgical Season</option>
        <option value="Advent">Advent</option>
        <option value="Christmas">Christmas</option>
        <option value="Ordinary Time">Ordinary Time</option>
        <option value="Lent">Lent</option>
        <option value="Easter">Easter</option>
    </select>
    <input id="enter-embed-code-facebook" type="text" placeholder="ends in 2F" style="display: none;">
    <div id="hidden-element" style="display: none;"></div>
    
    <script>
        let inputChecker = 0;
        let copyFacebookTextButton = document.getElementById('copy-facebook-text-button');
        let copyWebsiteCodeButton = document.getElementById('copy-website-code-button');
        let facebookText = "facebook text";
        let websiteCode = "website code";
        let enterDate = document.getElementById('enter-date');
        let enterDay = document.getElementById('enter-day');
        let streamStartHour = '07', // either do another input or have this based off of day of week
        streamStartMinute = '29'; // either do another input or have this based off of day of week, if input possibly doing a time input.
        weekendFacebookEmbed = 'https://www.facebook.com/watch/200206761419/170745247224514/'; //Sunday Masses playlist - facebook
        weekdayFacebookEmbed = 'https://www.facebook.com/watch/200206761419/305351103761003/'; //Daily Masses playlist - facebook
        weekendYoutubeEmbed = 'https://www.youtube.com/watch?v=fm9iA-YXvVw&list=PLbUheNz4CRLgAGl78M33YMg0T_xFv6eBO'; //Sunday Masses playlist - youtube
        weekdayYoutubeEmbed = 'https://www.youtube.com/playlist?list=PLbUheNz4CRLj7ST6XUszihIdZUUOzuSD1'; //Daily Masses playlist - youtube
        //Make a block of text for the Mass streaming announcement and display the proper announcement depending on the day of the week ie saturday vs weekday
        //need to change the naming convention for Sunday Mass jpg, or set up a rule so that displays as Sunday, vs input of Saturday.
        const daysOfWeek = ["Sunday", "Monday", "Tuesday", "Wednesday", "Thursday", "Friday", "Saturday"];
        let enterDateYear,
        enterDateDate,
        enterDateMonth,
        dayOfWeek,
        enterDateObjectMonth,
        enterDateObjectDay,
        enterDateObjectDayOfWeek,
        
        template;
        let newTemplate = document.getElementById('new-template');
        let liturgicalWeek = document.getElementById('liturgical-week'); //i.e. 18th
        let liturgicalSeason = document.getElementById('liturgical-season'); //i.e. Ordinary Time/Advent/Lent/Easter
        let meridiemIndicator = document.getElementById('meridiem-indicator');
        let celebrant = document.getElementById('celebrant');//Fr. First Last
        let celebrantTextInput = document.getElementById('celebrant-text-input');
        let displayCelebrant = celebrant.value;
        let embedCodeFacebook = document.getElementById('enter-embed-code-facebook');//ends in 2F

        
        // copy text to the clipboard
        function copyTextToClipboard(text){
            var textArea = document.createElement("textarea");
            textArea.style.position = 'fixed';
            textArea.style.top = 0;
            textArea.style.left = 0;
            textArea.style.width = '2em';
            textArea.style.height = '2em';
            textArea.style.padding = 0;
            textArea.style.border = 'none';
            textArea.style.outline = 'none';
            textArea.style.boxShadow = 'none';
            textArea.style.background = 'transparent';
            textArea.value = text;
            document.body.appendChild(textArea);
            textArea.focus();
            textArea.select();
            try {
                var successful = document.execCommand('copy');
                var msg = successful ? 'successful' : 'unsuccessful';
                console.log('Copying text command was ' + msg);
                console.log(text.value);
                console.log(typeof text);
            } catch (error) {
                console.log('Ope, unable to copy!');
            }
            document.body.removeChild(textArea);
        }
       //add event listener to make template button
       newTemplate.addEventListener('click', function(){
            makeTemplate();
        });
        //add event listeners to copy text buttons
        copyButtonsEventListeners();
        function copyButtonsEventListeners(){
        copyWebsiteCodeButton.addEventListener('click', function(){
            copyWebsiteCodeButton.setAttribute('disabled', '');
            copyTextToClipboard(websiteCode);
        })
        copyFacebookTextButton.addEventListener('click', function(){
            copyFacebookTextButton.setAttribute('disabled', '');
            let facebookCopyText = document.getElementById('facebook-copy-text');
            copyTextToClipboard(facebookCopyText.innerText);
        });
        }
        //======================================//
        //event listeners on input elements to show the next element
        enterDate.addEventListener('change', function(){
            console.log(enterDate.value);
            enterDay.style.visibility = "visible";
            enterDay.style.display = "inline";
            meridiemIndicator.style.display = "inline";
            meridiemIndicator.classList.add('border', 'border-warning');
            inputChecker = 0;
        });
        meridiemIndicator.addEventListener('change', function(){
            meridiemIndicator.classList.remove('border', 'border-warning');
            liturgicalWeek.style.display = "inline";
            liturgicalWeek.classList.add('border', 'border-warning');
        });
        liturgicalWeek.addEventListener('change', function(){
            liturgicalWeek.classList.remove('border', 'border-warning');
            celebrant.style.display = "inline";
            celebrant.classList.add('border', 'border-warning');
        });
        celebrant.addEventListener('change', function(){
            celebrant.classList.remove('border', 'border-warning');
            liturgicalSeason.style.display = "inline";
            liturgicalSeason.classList.add('border', 'border-warning');
        });
        liturgicalSeason.addEventListener('change', function(){
            liturgicalSeason.classList.remove('border', 'border-warning');
            embedCodeFacebook.style.display = "inline";
            embedCodeFacebook.classList.add('border', 'border-warning');
        });
        embedCodeFacebook.addEventListener('change', function(){
            embedCodeFacebook.classList.remove('border', 'border-warning');
            inputChecker = 1;
            alert('ready to make new template');
        });

        //======================================//
        //event listener on date input
        //event listener on date input to remove border danger
        enterDate.addEventListener('change', function(){
            enterDateUpdater();
            enterDate.classList.remove('border', 'border-warning');
        });
        //event listener on celebrant input
        celebrant.addEventListener('change', function(){
            if (celebrant.value == "Other"){
                celebrantTextInput.style.visibility = "visible";
                celebrantTextInput.style.display = "inline";
                celebrantTextInput.addEventListener('change', function(){
                displayCelebrant = celebrantTextInput.value;
                console.log(displayCelebrant);
                });
            } else {
                displayCelebrant = celebrant.value;
            };
        });
        //function to update the date
        function enterDateUpdater(){
            enterDateYear = enterDate.value.split("-")[0]; // ex. 2020
            enterDateYearShort = enterDate.value.split("-")[0].slice(-2); // ex. 2020
            enterDateMonth = enterDate.value.split("-")[1]; //ex. 08 (for august, leading zero)
            enterDateDate = enterDate.value.split("-")[2];// ex. 03(for the third, leading zero)
            displayDate = enterDateObjectMonth + "/" + enterDateObjectDay + "/" + enterDateYearShort;
            let enterDateObject = new Date(enterDateYear, enterDateMonth - 1, enterDateDate);
            console.log(enterDateObject);
            console.log(enterDateDate);
            enterDateObjectMonth = enterDateObject.getMonth() + 1;// add one
            console.log(enterDateObjectMonth);
            enterDateObjectDay = enterDateObject.getDate();//no leading zero
            enterDateObjectDayOfWeek = enterDateObject.getDay();//0-6
            console.log(enterDateObjectDayOfWeek);
            dayOfWeek = daysOfWeek[enterDateObjectDayOfWeek].toLowerCase();//lowercase day of week
            enterDay.value = daysOfWeek[enterDateObjectDayOfWeek];//capitalized day of week
            console.log(enterDay.value);
            let saturdayAnnouncementBlock = `For ${enterDay.value} ${displayDate}<br> Organ prelude starts shortly before the start of Mass at 5:15 PM` ;
            let weekdayAnnouncementBlock = `For ${enterDay.value} ${displayDate}<br>Mass will begin to stream at 7:30 AM`;
            if (enterDay.value == 'Saturday') {
                announcementBlock = saturdayAnnouncementBlock;
                streamStartHour = '17';
                streamStartMinute = '09';//pass in a string with leading zero if you want to keep the leading zero
                facebookEmbed = weekendFacebookEmbed;
                youtubeEmbed = weekendYoutubeEmbed;
                bulletinAnnouncement = `<br>Liturgy guide/bulletin here:<br>http://www.cathedralsaintpaul.org/bulletin<br>`;
            } else {
                announcementBlock = weekdayAnnouncementBlock;
                facebookEmbed = weekdayFacebookEmbed;
                youtubeEmbed = weekdayYoutubeEmbed;
                bulletinAnnouncement = '';

            }
        };
        function makeTemplate(){
            if(inputChecker == 0){
                alert("check inputs");
                return;
            } else {
            //ternary operator
            enterDateUpdater();
            copyFacebookTextButton.style.visibility = 'visible';
            copyWebsiteCodeButton.style.visibility = 'visible';
            console.log(enterDateYear); //expected output ex. 2020
            console.log(enterDateDate); //expected output ex. 03 (day of month, leading zero)
            console.log(enterDateMonth); //expected output ex. 08 (Aug. in this example, leading zero)
            console.log(dayOfWeek);
            console.log(enterDateObjectMonth); //expected output ex. 8 for August in this example, no leading zero)
            console.log(enterDateObjectDay); //expected output ex. 3 (day of month, no leading zero)
            facebookText = `
                <h1>Facebook Text</h1>
                <div id="facebook-copy-text">
                ${displayDate} Mass for ${enterDay.value} in the ${liturgicalWeek.value} Week in ${liturgicalSeason.value},<br> Cathedral of Saint Paul, St. Paul, MN <br>
                Celebrant: ${displayCelebrant}<br>
                Support the Cathedral here:<br>
                https://www.cathedralsaintpaul.org/give<br>
                ${bulletinAnnouncement}
                Mass readings available at a reduced subscription from Magnificat<br>
                English: www.magnificat.com/free<br>
                Spanish: www.magnificat.com/gratis<br>
                For children: www.magnifikid.com/free<br>
                <br>
                An Act of Spiritual Communion:<br>
                My Jesus, I believe that You are present in the Most Holy Sacrament.<br>
                I love You above all things, and I desire to receive You into<br>
                my soul. Since I cannot at this moment receive You sacramentally,<br>
                come at least spiritually into my heart. I embrace You as if You<br>
                were already there and unite myself wholly to You. Never permit<br>
                me to be separated from You. Amen</div>`;
            websiteCode = `
                <div style="text-align: center;">        
                <h1>Join Us For:</h1>
                <p>${displayDate} ${enterDay.value} Mass for the ${liturgicalWeek.value} Week in ${liturgicalSeason.value}</p>
                
                
                <em style="font-size: 14px;">Celebrant: ${displayCelebrant}</em>
                <div id="${dayOfWeek}${meridiemIndicator}-announcement">
                    <p style="margin: 0px;">
                        <em style="font-size: 14px;">
                            <span style="color:#ff0000;">
                                ${announcementBlock}
                            </span>
                        </em>
                    </p>
                </div>    
                <div id="${dayOfWeek}${meridiemIndicator}" style="text-align: center; background-image:url('/sites/default/files/files/${enterDateObjectMonth}_${enterDateObjectDay}%20${enterDay.value}%20${meridiemIndicator.value}%20Mass.jpg'); background-size: 400px 225px; width: 400px; height: 225px; margin: auto;">
                    <iframe id="${dayOfWeek}${meridiemIndicator.value}Iframe" style="visibility: hidden;" allowfullscreen="true" allowtransparency="true" frameborder="0" height="225" scrolling="no" src="${embedCodeFacebook.value}&show_text=0&width=560" style="border:none;overflow:hidden;" width="400"></iframe><!-- when embedding facebook live stream make sure to add at the end of the src "&show_text=0&width=560"-->
                </div>
                <div>
                    <p style="margin: 0px;">
                        <em>Note: After initial streaming, Mass will be available on Facebook <a href="${facebookEmbed}" target="_blank">here</a> & YouTube <a href="${youtubeEmbed}" target="_blank">here</a>.
                        </em>
                    </p>
                    <p style="margin:0px">
                        Mass readings available at a reduced subscription from Magnificat:
                    </p>
                    <ul style="list-style-type: none; margin-top: 0px;">
                        <li>
                            <a href="https://us.magnificat.net/free" target="_blank">
                                English
                            </a>
                        </li>
                        <li>
                            <a href="https://latina.magnificat.net/gratis" target="_blank">
                                Spanish
                            </a>
                        </li>
                        <li>
                            <a href="https://us.magnificat.net/flipbook/KID/sample/" target="_blank">
                                For Children
                            </a>
                        </li>
                    </ul>
                </div>
                
            </div>
            <hr>
            <script>
                let ${dayOfWeek}${meridiemIndicator.value}Announcement = document.getElementById("${dayOfWeek}${meridiemIndicator.value}-announcement");
                let ${dayOfWeek}${meridiemIndicator.value}iFrame = document.getElementById("${dayOfWeek}${meridiemIndicator.value}Iframe");
                let ${dayOfWeek}${meridiemIndicator.value} = document.getElementById("${dayOfWeek}${meridiemIndicator.value}");
                ${dayOfWeek}${meridiemIndicator.value}GetFormattedDate();
                let ${dayOfWeek}${meridiemIndicator.value}TimeChecker = setInterval(${dayOfWeek}${meridiemIndicator.value}GetFormattedDate, 1000);
                function ${dayOfWeek}${meridiemIndicator.value}GetFormattedDate(){
                    var ${dayOfWeek}${meridiemIndicator.value}Date = new Date();
                    var ${dayOfWeek}${meridiemIndicator.value}Mth = ${dayOfWeek}${meridiemIndicator.value}Date.getMonth() + 1;
                    var ${dayOfWeek}${meridiemIndicator.value}Dy = ${dayOfWeek}${meridiemIndicator.value}Date.getDate();
                    var ${dayOfWeek}${meridiemIndicator.value}Hr = ${dayOfWeek}${meridiemIndicator.value}Date.getHours();
                    var ${dayOfWeek}${meridiemIndicator.value}Min = ${dayOfWeek}${meridiemIndicator.value}Date.getMinutes();
                    var ${dayOfWeek}${meridiemIndicator.value}Sec = ${dayOfWeek}${meridiemIndicator.value}Date.getSeconds();
                    ${dayOfWeek}${meridiemIndicator.value}Mth = (${dayOfWeek}${meridiemIndicator.value}Mth < 10 ? "0" : "") + ${dayOfWeek}${meridiemIndicator.value}Mth;
                    ${dayOfWeek}${meridiemIndicator.value}Dy = (${dayOfWeek}${meridiemIndicator.value}Dy < 10 ? "0" : "") + ${dayOfWeek}${meridiemIndicator.value}Dy;
                    ${dayOfWeek}${meridiemIndicator.value}Hr = (${dayOfWeek}${meridiemIndicator.value}Hr < 10 ? "0" : "") + ${dayOfWeek}${meridiemIndicator.value}Hr;
                    ${dayOfWeek}${meridiemIndicator.value}Min = (${dayOfWeek}${meridiemIndicator.value}Min < 10 ? "0" : "") + ${dayOfWeek}${meridiemIndicator.value}Min;
                    ${dayOfWeek}${meridiemIndicator.value}Sec = (${dayOfWeek}${meridiemIndicator.value}Sec < 10 ? "0" : "") + ${dayOfWeek}${meridiemIndicator.value}Sec;
                    var ${dayOfWeek}${meridiemIndicator.value}Str = ${dayOfWeek}${meridiemIndicator.value}Mth + "-" + ${dayOfWeek}${meridiemIndicator.value}Dy + " " +  ${dayOfWeek}${meridiemIndicator.value}Hr + ":" + ${dayOfWeek}${meridiemIndicator.value}Min;
                    ${dayOfWeek}${meridiemIndicator.value}Month = "${enterDateMonth}";
                    ${dayOfWeek}${meridiemIndicator.value}Day = "${enterDateDate}";
                    ${dayOfWeek}${meridiemIndicator.value}Hour = "${streamStartHour}";
                    ${dayOfWeek}${meridiemIndicator.value}Minutes = "${streamStartMinute}";
                    var ${dayOfWeek}${meridiemIndicator.value}InputStr = ${dayOfWeek}${meridiemIndicator.value}Month + "-" + ${dayOfWeek}${meridiemIndicator.value}Day + " " + ${dayOfWeek}${meridiemIndicator.value}Hour + ":" + ${dayOfWeek}${meridiemIndicator.value}Minutes;
                    if (${dayOfWeek}${meridiemIndicator.value}Str < ${dayOfWeek}${meridiemIndicator.value}InputStr){
                        ${dayOfWeek}${meridiemIndicator.value}iFrame.style.visibility = "hidden";
                    } else {
                        ${dayOfWeek}${meridiemIndicator.value}iFrame.style.visibility = "visible";
                        ${dayOfWeek}${meridiemIndicator.value}.style.backgroundImage = "none";
                        ${dayOfWeek}${meridiemIndicator.value}Announcement.style.display = "none";
                        clearInterval(${dayOfWeek}${meridiemIndicator.value}TimeChecker);
                    }

                }
                
            <\/script>`;
            var template = `
            ${facebookText}
            <h1>Website Code</h1>
            ${websiteCode}`;
        
            let hiddenElement = document.getElementById('hidden-element');
            console.log(template);
            hiddenElement.insertAdjacentHTML('afterend', template);
}
}
    </script>
</body>
</html>

