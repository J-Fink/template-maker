<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Saturday Evening Mass</title>
</head>
<body>
    <button id="new-template">Make New Template</button>
    <button id="copy-text">Copy Text</button>
    <input id="enter-date" type="date" placeholder="Date: mm/dd/yyyy">
    <input id="enter-day" type="text" placeholder="Day: Monday">
    <input id="liturgical-week" type="text" placeholder="Liturgical Week: 18th">
    <input id="celebrant" type="text" placeholder="Celebrant: First Last">
    <input id="liturgical-season" type="text" placeholder="Advent/Ordinary Time/etc.">
    <input id="enter-embed-code-facebook" type="text" placeholder="ends in 2F">
    <div id="hidden-element"></div>
    
    <script>
        let copyText = document.getElementById('copy-text');
        function copyTextToClipboard(text){
            var textArea = document.createElement("textarea");
            textArea.style.position = 'fixed';
            textArea.style.top = 0;
            textArea.style.left = 0;
            textArea.style.width = '2em';
            textArea.style.height = '2em';
            textArea.style.padding = 0;
            textArea.style.border = 'none';
            textArea.style.outline = 'none';
            textArea.style.boxShadow = 'none';
            textArea.style.background = 'transparent';
            textArea.value = text;
            document.body.appendChild(textArea);
            textArea.focus();
            textArea.select();
            try {
                var successful = document.execCommand('copy');
                var msg = successful ? 'successful' : 'unsuccessful';
                console.log('Copying text command was ' + msg);
                console.log(text);
                console.log(typeof text);
            } catch (error) {
                console.log('Ope, unable to copy!');
            }
            document.body.removeChild(textArea);
        }
        copyText.addEventListener('click', function(){
            copyTextToClipboard(template);
        });
        let enterDate = document.getElementById('enter-date');
        let enterDay = document.getElementById('enter-day');
        let streamStartHour = '07', // either do another input or have this based off of day of week
        streamStartMinute = '29'; // either do another input or have this based off of day of week, if input possibly doing a time input.
        weekendFacebookEmbed = 'https://www.facebook.com/watch/200206761419/170745247224514/'; //Sunday Masses playlist - facebook
        weekdayFacebookEmbed = 'https://www.facebook.com/watch/200206761419/305351103761003/'; //Daily Masses playlist - facebook
        weekendYoutubeEmbed = 'https://www.youtube.com/watch?v=fm9iA-YXvVw&list=PLbUheNz4CRLgAGl78M33YMg0T_xFv6eBO'; //Sunday Masses playlist - youtube
        weekdayYoutubeEmbed = 'https://www.youtube.com/playlist?list=PLbUheNz4CRLj7ST6XUszihIdZUUOzuSD1'; //Daily Masses playlist - youtube
        //Make a block of text for the Mass streaming announcement and display the proper announcement depending on the day of the week ie saturday vs weekday
        //need to change the naming convention for Sunday Mass jpg, or set up a rule so that displays as Sunday, vs input of Saturday.
        const daysOfWeek = ["Sunday", "Monday", "Tuesday", "Wednesday", "Thursday", "Friday", "Saturday"];
        let enterDateYear,
        enterDateDate,
        enterDateMonth,
        dayOfWeek,
        enterDateObjectMonth,
        enterDateObjectDay,
        enterDateObjectDayOfWeek,
        displayDate,
        template;
        enterDate.addEventListener('change', function(){
            console.log(enterDate.value);
        })
        let newTemplate = document.getElementById('new-template');
        let liturgicalWeek = document.getElementById('liturgical-week'); //i.e. 18th
        let liturgicalSeason = document.getElementById('liturgical-season'); //i.e. Ordinary Time/Advent/Lent/Easter
        let celebrant = document.getElementById('celebrant');//Fr. First Last
        let embedCodeFacebook = document.getElementById('enter-embed-code-facebook');//ends in 2F
        function enterDateUpdater(){
            enterDateYear = enterDate.value.split("-")[0]; // ex. 2020
            enterDateYearShort = enterDate.value.split("-")[0].slice(-2); // ex. 2020
            enterDateMonth = enterDate.value.split("-")[1]; //ex. 08 (for august, leading zero)
            enterDateDate = enterDate.value.split("-")[2];// ex. 03(for the third, leading zero)
            displayDate = enterDateObjectMonth + "/" + enterDateObjectDay + "/" + enterDateYearShort;
            let enterDateObject = new Date(enterDateYear, enterDateMonth - 1, enterDateDate);
            console.log(enterDateObject);
            console.log(enterDateDate);
            enterDateObjectMonth = enterDateObject.getMonth() + 1;// add one
            console.log(enterDateObjectMonth);
            enterDateObjectDay = enterDateObject.getDate();//no leading zero
            enterDateObjectDayOfWeek = enterDateObject.getDay();//0-6
            console.log(enterDateObjectDayOfWeek);
            dayOfWeek = daysOfWeek[enterDateObjectDayOfWeek].toLowerCase();//lowercase day of week
            enterDay.value = daysOfWeek[enterDateObjectDayOfWeek];//capitalized day of week
            console.log(enterDay.value);
        let saturdayAnnouncementBlock = `For ${enterDay.value} ${displayDate}<br> Organ prelude starts shortly before the start of Mass at 5:15 PM` ;
        let weekdayAnnouncementBlock = `For ${enterDay.value} ${displayDate}<br>Mass will begin to stream at 7:30 AM`;
            if (enterDay.value == 'Saturday') {
                announcementBlock = saturdayAnnouncementBlock;
                streamStartHour = '17';
                streamStartMinute = '09';//pass in a string with leading zero if you want to keep the leading zero
                facebookEmbed = weekendFacebookEmbed;
                youtubeEmbed = weekendYoutubeEmbed;
                bulletinAnnouncement = `<br>Liturgy guide/bulletin here:<br>http://www.cathedralsaintpaul.org/bulletin<br>`;
            } else {
                announcementBlock = weekdayAnnouncementBlock;
                facebookEmbed = weekdayFacebookEmbed;
                youtubeEmbed = weekdayYoutubeEmbed;
                bulletinAnnouncement = '';

            }
        };
        enterDate.addEventListener('change', function(){
            enterDateUpdater();
        });
        function makeTemplate(){
            enterDateUpdater();
            console.log(enterDateYear); //expected output ex. 2020
            console.log(enterDateDate); //expected output ex. 03 (day of month, leading zero)
            console.log(enterDateMonth); //expected output ex. 08 (Aug. in this example, leading zero)
            console.log(dayOfWeek);
            console.log(enterDateObjectMonth); //expected output ex. 8 for August in this example, no leading zero)
            console.log(enterDateObjectDay); //expected output ex. 3 (day of month, no leading zero)
            var template = `
        <h1>Facebook Text</h1>
            ${displayDate} Mass for ${enterDay.value} in the ${liturgicalWeek.value} Week in ${liturgicalSeason.value},<br> Cathedral of Saint Paul, St. Paul, MN <br>
            Celebrant: Fr. John Ubel<br>
            Support the Cathedral here:<br>
            https://www.cathedralsaintpaul.org/give<br>
            ${bulletinAnnouncement}
            Mass readings available free from Magnificat<br>
            English: www.magnificat.com/free<br>
            Spanish: www.magnificat.com/gratis<br>
            For children: www.magnifikid.com/free<br>
            <br>
            An Act of Spiritual Communion:<br>
            My Jesus, I believe that You are present in the Most Holy Sacrament.<br>
            I love You above all things, and I desire to receive You into<br>
            my soul. Since I cannot at this moment receive You sacramentally,<br>
            come at least spiritually into my heart. I embrace You as if You<br>
            were already there and unite myself wholly to You. Never permit<br>
            me to be separated from You. Amen
        <div style="text-align: center;">
        <h1>Join Us For:</h1>
        <p>${displayDate} ${enterDay.value} Mass for the ${liturgicalWeek.value} Week in ${liturgicalSeason.value}</p>
        
        
        <em style="font-size: 14px;">Celebrant: Fr. ${celebrant.value}</em>
        <div id="${dayOfWeek}-announcement">
            <p style="margin: 0px;">
                <em style="font-size: 14px;">
                    <span style="color:#ff0000;">
                        ${announcementBlock}
                    </span>
                </em>
            </p>
        </div>    
        <div id="${dayOfWeek}Morning" style="text-align: center; background-image:url('/sites/default/files/files/${enterDateObjectMonth}_${enterDateObjectDay}%20${enterDay.value}%20Mass.jpg'); background-size: 400px 225px; width: 400px; height: 225px; margin: auto;">
            <iframe id="${dayOfWeek}MorningIframe" allowfullscreen="true" allowtransparency="true" frameborder="0" height="225" scrolling="no" src="${embedCodeFacebook.value}&show_text=0&width=560" style="border:none;overflow:hidden;" width="400"></iframe><!-- when embedding facebook live stream make sure to add at the end of the src "&show_text=0&width=560"-->
        </div>
        <div>
            <p style="margin: 0px;">
                <em>Note: After initial streaming, Mass will be available on Facebook <a href="${facebookEmbed}" target="_blank">here</a> & YouTube <a href="${youtubeEmbed}" target="_blank">here</a>.
                </em>
            </p>
            <p style="margin:0px">
                Mass readings available at a reduced subscription from Magnificat:
            </p>
            <ul style="list-style-type: none; margin-top: 0px;">
                <li>
                    <a href="https://us.magnificat.net/free" target="_blank">
                        English
                    </a>
                </li>
                <li>
                    <a href="https://latina.magnificat.net/gratis" target="_blank">
                        Spanish
                    </a>
                </li>
                <li>
                    <a href="https://us.magnificat.net/flipbook/KID/sample/" target="_blank">
                        For Children
                    </a>
                </li>
            </ul>
        </div>
        
    </div>
    <hr>
    <script>
        let ${dayOfWeek}AMAnnouncement = document.getElementById("${dayOfWeek}-announcement");
        let ${dayOfWeek}AMiFrame = document.getElementById("${dayOfWeek}MorningIframe");
        let ${dayOfWeek}AM = document.getElementById("${dayOfWeek}Morning");
        let ${dayOfWeek}AMTimeChecker = setInterval(${dayOfWeek}GetFormattedDate, 1000);
        function ${dayOfWeek}GetFormattedDate(){
            var ${dayOfWeek}Date = new Date();
            var ${dayOfWeek}Mth = ${dayOfWeek}Date.getMonth() + 1;
            var ${dayOfWeek}Dy = ${dayOfWeek}Date.getDate();
            var ${dayOfWeek}Hr = ${dayOfWeek}Date.getHours();
            var ${dayOfWeek}Min = ${dayOfWeek}Date.getMinutes();
            var ${dayOfWeek}Sec = ${dayOfWeek}Date.getSeconds();
            ${dayOfWeek}Mth = (${dayOfWeek}Mth < 10 ? "0" : "") + ${dayOfWeek}Mth;
            ${dayOfWeek}Dy = (${dayOfWeek}Dy < 10 ? "0" : "") + ${dayOfWeek}Dy;
            ${dayOfWeek}Hr = (${dayOfWeek}Hr < 10 ? "0" : "") + ${dayOfWeek}Hr;
            ${dayOfWeek}Min = (${dayOfWeek}Min < 10 ? "0" : "") + ${dayOfWeek}Min;
            ${dayOfWeek}Sec = (${dayOfWeek}Sec < 10 ? "0" : "") + ${dayOfWeek}Sec;
            var ${dayOfWeek}Str = ${dayOfWeek}Mth + "-" + ${dayOfWeek}Dy + " " +  ${dayOfWeek}Hr + ":" + ${dayOfWeek}Min;
            ${dayOfWeek}Month = "${enterDateMonth}";
            ${dayOfWeek}Day = "${enterDateDate}";
            ${dayOfWeek}Hour = "${streamStartHour}";
            ${dayOfWeek}Minutes = "${streamStartMinute}";
            var ${dayOfWeek}InputStr = ${dayOfWeek}Month + "-" + ${dayOfWeek}Day + " " + ${dayOfWeek}Hour + ":" + ${dayOfWeek}Minutes;
            if (${dayOfWeek}Str < ${dayOfWeek}InputStr){
                ${dayOfWeek}AMiFrame.style.visibility = "hidden";
                console.log("hide iframe");
                console.log(${dayOfWeek}Str)
                console.log(${dayOfWeek}InputStr)
            } else {
                ${dayOfWeek}AMiFrame.style.visibility = "visible";
                ${dayOfWeek}AM.style.backgroundImage = "none";
                console.log("show iframe");
                ${dayOfWeek}AMAnnouncement.style.visibility = "hidden";
                clearInterval(${dayOfWeek}AMTimeChecker);
            }

        }
        
    <\/script>`;
        
            let hiddenElement = document.getElementById('hidden-element');
            console.log(template);
            hiddenElement.insertAdjacentHTML('afterend', template);
}


        
        newTemplate.addEventListener('click', function(){
            makeTemplate();
        });

    </script>
</body>
</html>